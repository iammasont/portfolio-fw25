---
// src/pages/index.astro
// This is your main page, which assembles the components.
import Layout from '../layouts/Layout.astro';
import HeroWebGL from '../components/HeroWebGL.astro';
import ProjectCard from '../components/ProjectCard.astro';

// We define the project data here as an array of objects
const projects = [
  {
    category: "Live Events",
    title: "The Gathering at the Poetâ€™s Shack",
    tags: ["Media Servers", "d3", "Notch"]
  },
  {
    category: "Installation",
    title: "Dancing with the Stars Disney100 Night",
    tags: ["TouchDesigner", "Projection Mapping", "NDI"]
  },
  {
    category: "Broadcast",
    title: "Hydrogen Jukebox",
    tags: ["Unreal Engine", "LED Walls", "Real-time VFX"]
  },
  {
    category: "Concert",
    title: "Festival Headliner",
    tags: ["Systems Integration", "Resolume", "IMAG"]
  },
  {
    category: "Experiential",
    title: "Brand Activation",
    tags: ["TouchDesigner", "Interactive", "Kinect"]
  },
  {
    category: "Corporate",
    title: "Product Launch",
    tags: ["Media Servers", "Disguise", "Motion Graphics"]
  }
];
---
<!-- We wrap everything in the Layout component -->
<Layout title="Nate Wilkens - Portfolio">
  
  <!-- Here is your Hero component -->
  <HeroWebGL />

  <!-- Here is the Projects section -->
  <section id="projects">
    <div class="section-header">
        <div class="year-label">Selected Work / 2024</div>
        <h2 class="section-title">Projects</h2>
    </div>
    
    <div class="project-grid">
      <!-- 
        We map over the projects array and render a ProjectCard
        component for each one, passing in the data as props.
      -->
      {projects.map(project => (
        <ProjectCard 
          category={project.category} 
          title={project.title} 
          tags={project.tags} 
        />
      ))}
    </div>
  </section>

</Layout>

<!-- 
  This client script applies the .is-long class
  to project titles that need it.
-->
<script is:inline>
  function adjustProjectTitles() {
      const titles = document.querySelectorAll('.project-title');
      // This is the character count threshold you can tweak
      const LONG_TITLE_THRESHOLD = 28; 

      titles.forEach(title => {
          if (!title) return; // Safety check
          const length = title.textContent.trim().length;
          if (length > LONG_TITLE_THRESHOLD) {
              title.classList.add('is-long');
          } else {
              title.classList.remove('is-long');
          }
      });
  }
  
  // Run when the page loads
  document.addEventListener('astro:page-load', adjustProjectTitles);
  // Re-run on resize for responsive clamp() changes
  window.addEventListener('resize', adjustProjectTitles);
</script>

<!-- 
  These are page-specific styles for the layout
  of the projects section.
-->
<style>
  #projects {
      background: var(--red);
      padding: 0 5svw 100px;
      position: relative;
  }
  
  .section-header {
      margin-bottom: 20px;
  }
  
  .year-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-weight: 500;
      margin: 0;
    }
  
  .section-title {
      font-family: 'Geist', sans-serif;
      font-weight: 700;
      font-size: clamp(2rem, 12svw, 7rem);
      letter-spacing: -0.03em;
      line-height: 1.1;
      margin: 2rem 0;
      margin-bottom:5rem;
    }
  
  .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 40px 30px;
      max-width: 1400px;
      padding-left: 10svw;
      /* This prevents items from stretching to the tallest height */
      align-items: start;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
      #projects {
          padding: 0 5svw 60px;
      }
      
      .project-grid {
          grid-template-columns: 1fr;
          gap: 36px;
      }
      
      .section-header {
          margin-bottom: 32px;
      }
  }
</style>
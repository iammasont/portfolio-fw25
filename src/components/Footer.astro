---
// src/components/Footer.astro
// Fixed footer with gradient overlay (transparent → orange)
// Mobile: Slides up from below screen on tap
---

<footer id="main-footer">
  <div class="footer-gradient-container">
    <!-- Color gradient -->
    <div class="footer-gradient-color"></div>
    <!-- Progressive blur layers - 9 overlapping sections (matching navbar recipe) -->
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
    <div class="blur-filter"></div>
  </div>
  
  <!-- Mobile Toggle Button (always in DOM, only visible on mobile) -->
  <button id="footer-toggle" class="footer-toggle" aria-label="Toggle footer">
    <svg class="chevron-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <div class="footer-content">
    <div class="footer-left">
      <p class="footer-bio">
        Nathaniel Wilkens is a Technical Artist who specializes in<br>
        Realtime Content, Augmented Reality, ICVFX and Media Servers.
      </p>
    </div>
    <div class="footer-center">
      <p class="footer-location">
        Based in Cincinnati, OH<br>
        Selected Work '20-25
      </p>
    </div>
    <div class="footer-right">
      <a href="/cv" class="footer-link" data-hover="true">Download CV</a>
      <p class="footer-copyright">©2025 All Rights Reserved</p>
    </div>
  </div>
</footer>

<script>
  function initFooterToggle() {
    const footer = document.getElementById('main-footer');
    const toggle = document.getElementById('footer-toggle');

    if (!footer || !toggle) return;

    const isMobile = () => window.innerWidth <= 768;

    // Initial state
    if (isMobile()) {
      footer.classList.add('mobile-hidden');
    } else {
      footer.classList.remove('mobile-hidden');
    }

    toggle.addEventListener('click', () => {
      if (isMobile()) {
        footer.classList.toggle('mobile-hidden');
      }
    });

    // Handle resize
    let resizeTimer: number;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = window.setTimeout(() => {
        if (isMobile()) {
          footer.classList.add('mobile-hidden');
        } else {
          footer.classList.remove('mobile-hidden');
        }
      }, 250);
    });
  }

  document.addEventListener('astro:page-load', initFooterToggle);
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFooterToggle);
  } else {
    initFooterToggle();
  }
</script>

<style>
  :root {
    --ease-out-timing: cubic-bezier(0.165, 0.84, 0.44, 1);
    --footer-transition: 0.6s var(--ease-out-timing);
  }

  /* Fixed Footer */
  #main-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 9999;
    pointer-events: none; /* Allow clicks through gradient */
    transition: transform var(--footer-transition);
  }

  /* Mobile: Hide footer below screen by default */
  @media (max-width: 768px) {
    #main-footer.mobile-hidden {
      transform: translateY(calc(100% - 20px)); /* Show less - just icon peek */
    }
  }

  /* Mobile Toggle Button */
  .footer-toggle {
    display: none; /* Hidden on desktop */
    position: absolute;
    top: -32px; /* Closer to footer content */
    left: 50%;
    transform: translateX(-50%);
    width: auto;
    height: auto;
    background: transparent; /* No background */
    border: none; /* No border */
    cursor: pointer;
    pointer-events: auto;
    z-index: 10;
    transition: transform var(--footer-transition), opacity 0.2s ease;
    align-items: center;
    justify-content: center;
    padding: 4px; /* Minimal padding */
    opacity: 0;
  }

  @media (max-width: 768px) {
    .footer-toggle {
      display: flex; /* Show on mobile */
      opacity: 1;
      pointer-events: auto;
    }
  }

  .footer-toggle:hover {
    opacity: 0.7;
  }

  .footer-toggle:active {
    transform: translateX(-50%) scale(0.9);
  }

  /* Chevron Icon */
  .chevron-icon {
    color: var(--black);
    transition: transform var(--footer-transition);
  }

  /* Rotate chevron when footer is open */
  #main-footer:not(.mobile-hidden) .chevron-icon {
    transform: rotate(180deg);
  }

  /* Gradient Container - scales up on smaller screens */
  .footer-gradient-container {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 120px;
    pointer-events: none;
  }

  /* Scale up gradient on tablet */
  @media (max-width: 1024px) {
    .footer-gradient-container {
      height: 180px;
    }
  }

  /* Scale up more on mobile */
  @media (max-width: 768px) {
    .footer-gradient-container {
      height: 240px;
    }
  }

  /* Color gradient layer */
  .footer-gradient-color {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, rgba(208, 92, 42, 0) 0%, var(--red) 100%);
    pointer-events: none;
  }

  /* Progressive blur filters - using navbar recipe inverted for footer */
  .footer-gradient-container > .blur-filter {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  /* Layer 1: lightest blur (top of footer, toward middle of page) */
  .footer-gradient-container > .blur-filter:nth-child(2) {
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 0%, 
      rgba(0, 0, 0, 1) 10%, 
      rgba(0, 0, 0, 1) 30%, 
      rgba(0, 0, 0, 0) 70%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 0%, 
      rgba(0, 0, 0, 1) 10%, 
      rgba(0, 0, 0, 1) 30%, 
      rgba(0, 0, 0, 0) 70%
    );
  }

  /* Layer 2 */
  .footer-gradient-container > .blur-filter:nth-child(3) {
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 5%, 
      rgba(0, 0, 0, 1) 20%, 
      rgba(0, 0, 0, 1) 40%, 
      rgba(0, 0, 0, 0) 60%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 5%, 
      rgba(0, 0, 0, 1) 20%, 
      rgba(0, 0, 0, 1) 40%, 
      rgba(0, 0, 0, 0) 60%
    );
  }

  /* Layer 3 */
  .footer-gradient-container > .blur-filter:nth-child(4) {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 10%, 
      rgba(0, 0, 0, 1) 30%, 
      rgba(0, 0, 0, 1) 50%, 
      rgba(0, 0, 0, 0) 50%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 10%, 
      rgba(0, 0, 0, 1) 30%, 
      rgba(0, 0, 0, 1) 50%, 
      rgba(0, 0, 0, 0) 50%
    );
  }

  /* Layer 4 */
  .footer-gradient-container > .blur-filter:nth-child(5) {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 20%, 
      rgba(0, 0, 0, 1) 40%, 
      rgba(0, 0, 0, 1) 60%, 
      rgba(0, 0, 0, 0) 40%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 20%, 
      rgba(0, 0, 0, 1) 40%, 
      rgba(0, 0, 0, 1) 60%, 
      rgba(0, 0, 0, 0) 40%
    );
  }

  /* Layer 5 */
  .footer-gradient-container > .blur-filter:nth-child(6) {
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 30%, 
      rgba(0, 0, 0, 1) 50%, 
      rgba(0, 0, 0, 1) 70%, 
      rgba(0, 0, 0, 0) 30%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 30%, 
      rgba(0, 0, 0, 1) 50%, 
      rgba(0, 0, 0, 1) 70%, 
      rgba(0, 0, 0, 0) 30%
    );
  }

  /* Layer 6 */
  .footer-gradient-container > .blur-filter:nth-child(7) {
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 40%, 
      rgba(0, 0, 0, 1) 60%, 
      rgba(0, 0, 0, 1) 80%, 
      rgba(0, 0, 0, 0) 20%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 40%, 
      rgba(0, 0, 0, 1) 60%, 
      rgba(0, 0, 0, 1) 80%, 
      rgba(0, 0, 0, 0) 20%
    );
  }

  /* Layer 7 */
  .footer-gradient-container > .blur-filter:nth-child(8) {
    backdrop-filter: blur(32px);
    -webkit-backdrop-filter: blur(32px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 50%, 
      rgba(0, 0, 0, 1) 70%, 
      rgba(0, 0, 0, 1) 90%, 
      rgba(0, 0, 0, 0) 10%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 50%, 
      rgba(0, 0, 0, 1) 70%, 
      rgba(0, 0, 0, 1) 90%, 
      rgba(0, 0, 0, 0) 10%
    );
  }

  /* Layer 8 */
  .footer-gradient-container > .blur-filter:nth-child(9) {
    backdrop-filter: blur(48px);
    -webkit-backdrop-filter: blur(48px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 60%, 
      rgba(0, 0, 0, 1) 80%, 
      rgba(0, 0, 0, 1) 95%, 
      rgba(0, 0, 0, 0) 5%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 60%, 
      rgba(0, 0, 0, 1) 80%, 
      rgba(0, 0, 0, 1) 95%, 
      rgba(0, 0, 0, 0) 5%
    );
  }

  /* Layer 9: heaviest blur (bottom of footer) */
  .footer-gradient-container > .blur-filter:nth-child(10) {
    backdrop-filter: blur(64px);
    -webkit-backdrop-filter: blur(64px);
    mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 70%, 
      rgba(0, 0, 0, 1) 90%, 
      rgba(0, 0, 0, 1) 100%
    );
    -webkit-mask: linear-gradient(to bottom, 
      rgba(0, 0, 0, 0) 70%, 
      rgba(0, 0, 0, 1) 90%, 
      rgba(0, 0, 0, 1) 100%
    );
  }

  /* Footer Content (interactive elements) */
  .footer-content {
    position: relative;
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 40px;
    padding: 24px 5vw;
    pointer-events: auto; /* Re-enable clicks for content */
  }

  .footer-left,
  .footer-center,
  .footer-right {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
  }

  .footer-left {
    align-items: flex-start;
  }

  .footer-center {
    align-items: center;
    text-align: center;
  }

  .footer-right {
    align-items: flex-end;
    text-align: right;
  }

  .footer-bio,
  .footer-location,
  .footer-copyright {
    font-family: 'Geist Mono', monospace;
    font-size: 0.75rem;
    line-height: 1.4;
    color: var(--black);
    margin: 0;
    font-weight: 400;
  }

  .footer-link {
    font-family: 'Geist Mono', monospace;
    font-size: 0.75rem;
    color: var(--black);
    text-decoration: underline;
    margin-bottom: 8px;
    font-weight: 500;
    transition: opacity 0.2s ease-out;
  }

  .footer-link:hover {
    opacity: 0.6;
  }

  /* Responsive - Tablet */
  @media (max-width: 1024px) {
    .footer-content {
      grid-template-columns: 1fr;
      gap: 16px; /* Tighter spacing on tablet */
      text-align: left;
    }

    .footer-left,
    .footer-center,
    .footer-right {
      align-items: flex-start;
      text-align: left;
    }
  }

  /* Responsive - Small Tablet (handles the awkward wrapping zone) */
  @media (max-width: 960px) {
    .footer-gradient-container {
      height: 200px; /* Intermediate height */
    }

    .footer-content {
      /* Switch to 2-column earlier to prevent wrapping */
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 12px 16px;
    }

    .footer-left {
      grid-column: 1 / -1;
      grid-row: 1;
    }

    .footer-center {
      grid-column: 1;
      grid-row: 2;
    }

    .footer-right {
      grid-column: 2;
      grid-row: 2;
      align-items: flex-end;
      text-align: right;
    }

    .footer-bio,
    .footer-location,
    .footer-copyright,
    .footer-link {
      font-size: 0.6875rem; /* Slightly smaller to prevent wrapping */
    }
  }

  /* Responsive - Mobile */
  @media (max-width: 768px) {
    .footer-bio {
    max-width: 45ch; /* Adjust this value to control line breaks */
    text-align: center;
    align-self: center;
    letter-spacing: -.25px;
  }
    .footer-content {
      /* New layout: bio spans top, location left / copyright right on bottom */
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 10px 16px; /* Tighter vertical gap, horizontal gap between location/copyright */
      padding: 20px 5vw;
    }

    /* Bio spans full width on top */
    .footer-left {
      grid-column: 1 / -1;
      grid-row: 1;
    }

    /* Location on bottom left */
    .footer-center {
      grid-column: 1;
      grid-row: 2;
      align-items: flex-start;
      text-align: left;
    }

    /* Copyright + CV link on bottom right */
    .footer-right {
      grid-column: 2;
      grid-row: 2;
      align-items: flex-end;
      text-align: right;
    }

    .footer-bio br,
    .footer-location br,
    .footer-copyright br {
      display: none;
    }

    .footer-bio,
    .footer-location,
    .footer-copyright,
    .footer-link {
      font-size: 0.65rem;
      line-height: 1.3; /* Tighter line height on mobile */
    }
  }
</style>